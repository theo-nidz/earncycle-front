

<div>
  <div class="w-screen h-screen z-10 relative"
  leaflet
  [leafletOptions]="options"
  [leafletLayers]="userPosition"
  [(leafletCenter)]="center"
  (leafletMapReady)="onMapReady($event)"
  [(leafletZoom)]="zoom"
  [leafletMarkerCluster]="[layers]"

  *ngIf="options">
  </div>
  <div class="absolute flex flex-col-reverse right-1 bottom-20 md:bottom-24 sm:right-3  z-50 gap-1">
    <button (click)="goUser()" class=" rounded-full bg-primary relative  w-12 h-12  md:w-14 md:h-14 hover:bg-hover "><img src="assets/images/global/userMarker.png"  class="w-6 h-6  md:w-8 md:h-8 absolute top-1/2 left-1/2 -translate-x-2/4 -translate-y-2/4"></button>
    <button (click)="openFilter()" class="rounded-full bg-primary  w-12 h-12  md:w-14 md:h-14 relative hover:bg-hover "><img src="assets/images/index/filter.svg" class="w-6 h-6  absolute top-1/2 left-1/2 -translate-x-2/4 -translate-y-2/4"></button>
    <button *ngIf="isRoute" (click)="openCancelRoute()" class=" rounded-full bg-primary relative  w-12 h-12  md:w-14 md:h-14 hover:bg-hover  "><img src="assets/images/index/cancelRoute.svg"  class="w-6 h-6  absolute top-1/2 left-1/2 -translate-x-2/4 -translate-y-2/4"></button>
    <button (click)="userAchievement()" class="rounded-full bg-primary  w-12 h-12  md:w-14 md:h-14 relative hover:bg-hover ">Test</button>

  </div>
</div>

<div class="absolute top-0  md:left-3/4 right-0 bottom-0 bg-light z-50 border-l border-dark rounded overflow-y-auto filterBar" *ngIf="modalFilter == true">
<div class="flex justify-between p-3 fixed bg-light md:left-3/4 right-0 border"><h2 class="pr-5">Filter par cat√©gorie</h2> <div><img src="assets/images/global/cancel.svg" class="w-6 h-6 hover:cursor-pointer" (click)="closeFilter()" /> </div></div>
<div class="flex flex-col p-3 gap-4 mt-14">

<p (click)="setMarkers()" *ngIf="filterActive" class="hover:cursor-pointer font-bold">Reinitialiser Filtres</p>

<button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Other')">Autre</button>

 <button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Glass')">Verre</button>

 <button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Waste')">Ordures m√©nag√®res</button>

 <button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Wood')">Bois</button>

 <button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Cardboard')">Cartons</button>

 <button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Metal')">M√©tal</button>

 <button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Plastic')">Plastique</button>

 <button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Clothes')">V√™tements</button>

 <button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Compost')">Composte</button>

 <button class="bg-primary rounded p-3 hover:bg-hover" (click)="filter('Recycling')">Recyclage</button>

</div>
</div>



<div class="absolute w-full h-full top-0 z-50 achievement--bg" *ngIf="userAchievementPopup">
  <div class="relative top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 bg-light rounded p-4  max-w-xs achievement--inner">
    <img src="assets/images/global/cancel.svg" class="w-6 h-6 hover:cursor-pointer absolute top-3 right-3" (click)="closeAchievement()" />
    <div *ngIf="userAchievementLogged">
      <div class="success-checkmark">
        <div class="check-icon">
          <span class="icon-line line-tip"></span>
          <span class="icon-line line-long"></span>
          <div class="icon-circle"></div>
          <div class="icon-fix"></div>
        </div>
      </div>
      <div class="achievement--info">
        <h2 class="text-primary ">Trajet Valid√© !</h2>
        <p>Vous avez plant√© 1 arbre ! üå≥</p>
      <div class="flex items-center gap-2">
        <p> + {{coins}} pi√®ces </p> <img class="w-8 h-8" src="/assets/coins.svg" alt="image pi√®ce profile"/>
      </div>
       <a href="/coupon">Voir les offres</a>
      </div>
    </div>
    <div *ngIf="!userAchievementLogged">
      <div class="achievement--info">
        <h2 class="text-primary ">Trajet Valid√© !</h2>
        <p class="pt-4">Vous n'avez pas encore de compte !</p>
        <p class="text-center pt-2">Cr√©ez-vous un compte d√®s maintenant pour gagner des pi√®ces et les utiliser dans les <a href="/coupon" class="hover:underline">offres</a>.</p>
       <a href="/register" class="pt-4 hover:underline">Je cr√©e mon compte !</a>
      </div>
    </div>

  </div>
</div>


<div class="absolute w-full h-full top-0 z-50 cancel--bg" *ngIf="cancelRoutePopup">
  <div class="relative top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 bg-light rounded p-4  max-w-xs">
        <h2 class="text-primary text-center">Voulez-vous annuler votre trajet ?</h2>
        <div class="flex pt-2 justify-center gap-5">
          <button (click)="cancelRoute()" class="rounded bg-primary p-2 text-light font-bold hover:bg-hover">Confirmer</button>
          <button (click)="closeCancelRoute()" class="rounded bg-error p-2 text-light font-bold close">Retour</button>
        </div>
  </div>
</div>

<div class="absolute w-full h-full top-0 z-50 loader--bg" *ngIf="loading">
  <div class="loader--loading relative top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50 bg-light rounded p-4 before:bg-primary " >
    <span class="flex flex-col items-center ">
      <img class="animate-spin " src="assets/images/global/loader.png" alt="Loading" draggable="false">
      Chargement...</span>
  </div>
</div>








